import { Callout } from "nextra/components";
import Image from "next/image";
import { Tabs } from 'nextra/components'
import { Cards, Card } from 'nextra/components'

# Looping
The native lending facility enables users to establish a leveraged position in a Baseline token. This is achieved by depositing bTokens into the lending facility, taking out a loan, and then using that loan to buy more bTokens. This process can be repeated multiple times and is known as looping.

### How Looping Works
Here’s a simplified example to illustrate how looping works. For this example, we assume there are no additional costs such as slippage, borrowing fees, or swap fees.

**0. Initial Position**
- User owns 1,000 bTokens, each valued at the market price of 1.20 USDC.
- The Baseline Value (BLV) of each bToken is 1.00 USDC.

**1. First Loop**
- User deposits 1,000 bTokens into the lending facility.
- User withdraws 1,000 USDC from the lending facility.
- With the 1,000 USDC, the user buys 833.33 bTokens at market price.

**2. Second Loop**
- User deposits 833.33 bTokens into the lending facility.
- User withdraws 833.33 USDC from the lending facility.
- With the 833.33 USDC, the user buys 694.44 bTokens at market price.

**At the End of Two Loops**
- Collateral: 1,833.33 bTokens (from both deposit steps).
- Wallet Holdings: 694.44 bTokens.
- Debt: 1,833.33 USDC (from both withdrawal steps).

In total, the user has 2,527.77 bTokens (combining both deposited and wallet holdings) and 1,833.33 USDC in debt. Despite the increased bToken holdings, the overall value of the position remains the same as initially calculated, assuming no fees:

- Initial Value: 1,000 bTokens @ 1.20 USDC = 1,200 USDC.
- Looping Value: 2,527.77 bTokens @ 1.20 USDC = 3,033.32 USDC. When you account for 1,833.33 USDC of debt, you’re left with the same 1,200 USDC.

<Callout type="info" emoji="">
Looping is not an action that can be performed indefinitely. Notice how in the example above, each successive loop results in reduced borrowing power. This is due to the difference between the bToken’s market price and BLV. 
</Callout>

### Looping Benefits, Risks, and How to Exit
For further information on looping, please review the following tabs:

<Callout emoji="">
<Tabs items={['Looping Benefits', 'Looping Risks', 'When to Loop', 'How to Loop', 'How to Exit a Loop']}>
  <Tabs.Tab>
   When you loop your position, you are betting on the upside of the bToken against the reserve asset. By looping, you can gain more exposure to the asset without having to invest additional capital. 

   ![11](/assets/11.png)
  </Tabs.Tab>

  <Tabs.Tab>
   If the price of bTokens falls relative to the reserve asset, your position will incur greater losses. This is because your leveraged position has outsized exposure to the bToken, and your collateral value decreases more than your borrow value. In addition to pricing risk, there is loan default risk for opening a leveraged position.
  </Tabs.Tab>

  <Tabs.Tab>
   Looping near the BLV poses the least amount of risk because the supporting liquidity structure from the Floor prevents the price from dropping significantly. In addition, looping near BLV is a lot more capital efficient since you’re able to achieve a higher loan-to-value (LTV).
  </Tabs.Tab>

  <Tabs.Tab>
   Looping is now a built-in feature which allows a user to deposit their bTokens and set a leverage level. The system will loop your position until the desired leverage level is met.
  </Tabs.Tab>

  <Tabs.Tab>
  Exiting a loop is simply inverting the steps for creating a looped position. The process involves repaying your debt, accessing your collateral, and selling your collateral to repay more debt. It’s possible to partially unwind your looped position, or fully unwind it back into the reserve asset.

  </Tabs.Tab>
</Tabs>
</Callout>

